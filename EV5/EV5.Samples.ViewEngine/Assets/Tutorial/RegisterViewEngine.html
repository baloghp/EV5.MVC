<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0" name="viewport">

    <title>EV5.Mvc Tutorial 4 - Initializing View Engine and Plugins for your application</title>
    <meta content="" name="description">
    <meta content="" name="keywords">

    <!-- Favicons -->
    <link href="/img/favicon.png" rel="icon">
    <link href="/img/apple-touch-icon.png" rel="apple-touch-icon">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Jost:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i" rel="stylesheet">

    <!-- Vendor CSS Files -->
    <link href="/vendor/aos/aos.css" rel="stylesheet">
    <link href="/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/vendor/bootstrap-icons/bootstrap-icons.css" rel="stylesheet">
    <link href="/vendor/boxicons/css/boxicons.min.css" rel="stylesheet">
    <link href="/vendor/glightbox/css/glightbox.min.css" rel="stylesheet">
    <link href="/vendor/remixicon/remixicon.css" rel="stylesheet">
    <link href="/vendor/swiper/swiper-bundle.min.css" rel="stylesheet">

    <!-- Template Main CSS File -->
    <link href="/css/style.css" rel="stylesheet">

    <!-- =======================================================
    * Template Name: Arsha - v4.3.0
    * Template URL: https://bootstrapmade.com/arsha-free-bootstrap-html-template-corporate/
    * Author: BootstrapMade.com
    * License: https://bootstrapmade.com/license/
    ======================================================== -->
</head>

<body>
    <!-- ======= Header ======= -->
    <header id="header" class="fixed-top header-inner-pages">
        <div class="container d-flex align-items-center">

            <h1 class="logo me-auto"><a href="index.html">EV5.MVC</a></h1>
            <!-- Uncomment below if you prefer to use an image logo -->
            <!-- <a href="index.html" class="logo me-auto"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->

            <nav id="navbar" class="navbar">
                <ul>
                    <li>
                        <a class="active nav-link scrollto" href="/index#hero">Home</a>
                    </li>
                    <li>
                        <a class="nav-link scrollto" href="/index#about">About</a>
                    </li>
                    <li>
                        <a class="nav-link scrollto" href="/index#features">Features</a>
                    </li>
                    <li>
                        <a class="nav-link   scrollto" href="/index#tutorials">Turorial</a>
                    </li>
                    <li>
                        <a class="nav-link   scrollto" href="/index#demos">Demos</a>
                    </li>
                    <li>
                        <a class="nav-link scrollto" href="/index#contact">Contact</a>
                    </li>
                    <li>
                        <a class="getstarted scrollto" href="/index#about">Get Started</a>
                    </li>
                </ul>
                <i class="bi bi-list mobile-nav-toggle"></i>
            </nav><!-- .navbar -->

        </div>
    </header><!-- End Header -->
    <main id="main">

        <!-- ======= Breadcrumbs ======= -->
        <section id="breadcrumbs" class="breadcrumbs">
            <div class="container">

                <ol>
                    <li><a href="/index">Home</a></li>
                    <li>Initializing View Engine and Plugins for your application</li>
                </ol>
                <h2>Initializing View Engine and Plugins for your application</h2>

            </div>
        </section>
    <!-- End Breadcrumbs -->

        <section class="inner-page">
            <div class="container">
                <div class="row">
                    <div class="col-md-12">

                        <h3>Initializing the EV5 ViewEngine</h3>
                        <p>
                            In the Startup class you can add the ViewEngine to the list of used MVC ViewEngines via the following line:
                            <pre style="font-family:Consolas;font-size:13px;color:gainsboro;background:#1e1e1e;">services<span style="color:#b4b4b4;">.</span>AddRazorPages()
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#b4b4b4;">.</span>AddViewOptions(<span style="color:#9cdcfe;">o</span>&nbsp;<span style="color:#b4b4b4;">=&gt;</span>&nbsp;o<span style="color:#b4b4b4;">.</span>ViewEngines<span style="color:#b4b4b4;">.</span>Insert(<span style="color:#b5cea8;">0</span>,&nbsp;<span style="color:#569cd6;">new</span>&nbsp;EmbeddedViewEngine(<span style="color:#d69d85;">&quot;eve-&quot;</span>)));</pre>

                            Here we are suing the AddViewOptions extensionmethod of the IMvcBuilder interface.
                            Note, that you can specify the place of the ViewEngine. It's order will determine the order in which the MVC engine will look for the view names in the engines.
                            So, if you are using EV5 ViewEngine primarily, you can specify that to be the first.

                            Also note, that you can specify a prefix for the registered EV5 ViewEngine. The EV5 ViewEngine will only process views with a name starting with this prefix.
                            This way you can register multiple EV5 viewengines, and direct specific views to specific engines.

                        </p>

                        <h3 class="panel-heading">Calling the Embedded Views</h3>
                        <p>
                            Once the ViewEngine is registered 

                        </p>

                        <h3 class="panel-heading">Auto Discovering and registering the web parts of plugins</h3>
                        <p>
                            Use the UseEmbeddedPlugins extension of the IServiceCollection in the ConfigureServices method to auto discover the plugins.
                            You have to specify the ICompositionHostFactory that is responsible to find all the IEmbeddedPlugin implementations.
                            By default use the DirCompositionHostFactory class to specify a directory and a search pattern to consider all relevant assemblies.

                            <pre style="font-family:Consolas;font-size:13px;color:gainsboro;background:#1e1e1e;"><span style="color:#57a64a;">//This&nbsp;method&nbsp;will&nbsp;discover&nbsp;all&nbsp;exported&nbsp;IEmbeddedPlugins&nbsp;in&nbsp;the&nbsp;provided&nbsp;CompositionHostFactory</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#57a64a;">//It&nbsp;will&nbsp;then&nbsp;use&nbsp;the&nbsp;information&nbsp;in&nbsp;these&nbsp;objects&nbsp;to&nbsp;set&nbsp;up&nbsp;the&nbsp;web&nbsp;components&nbsp;and.</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;services<span style="color:#b4b4b4;">.</span>UseEmbeddedPlugins(<span style="color:#569cd6;">new</span>&nbsp;DirCompositionHostFactory(AppDomain<span style="color:#b4b4b4;">.</span>CurrentDomain<span style="color:#b4b4b4;">.</span>BaseDirectory,&nbsp;<span style="color:#d69d85;">&quot;EV5*.dll&quot;</span>));</pre>

                        </p>

                        <h3 class="panel-heading">Prepare File Providers for using the plugins</h3>
                        <p>
                            Use the ConfigureEmbeddedPlugins extension of the IWebHostEnvironment in the Configure method
                            to auto discover the plugins and prepare the environemnt to use CompositeFileProvider containing the FileProviders of the plugins.
                            <pre style="font-family:Consolas;font-size:13px;color:gainsboro;background:#1e1e1e;">env<span style="color:#b4b4b4;">.</span>ConfigureEmbeddedPlugins();
</pre>
                            You can use this version of the configure method to access the IWebHostEnvironment:
                            <pre style="font-family:Consolas;font-size:13px;color:gainsboro;background:#1e1e1e;"><span style="color:#569cd6;">public</span>&nbsp;<span style="color:#569cd6;">void</span>&nbsp;<span style="color:#dcdcaa;">Configure</span>(IApplicationBuilder&nbsp;<span style="color:#9cdcfe;">app</span>,&nbsp;IWebHostEnvironment&nbsp;<span style="color:#9cdcfe;">env</span>)
</pre>

                    </div>
                </div>
            </div>
        </section>

    </main><!-- End #main -->
    <!-- ======= Footer ======= -->
    <footer id="footer">
        <div class="footer-newsletter">
            <div class="container">
                <div class="row justify-content-center">
                    <div class="col-lg-6">
                        <h4>Join Our Newsletter</h4>
                        <p>Tamen quem nulla quae legam multos aute sint culpa legam noster magna</p>
                        <form action="" method="post">
                            <input type="email" name="email">
                            <input type="submit" value="Subscribe">
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="footer-top">
            <div class="container">
                <div class="row">
                    <div class="col-lg-3 col-md-6 footer-contact">
                        <h3><strong style="font-family: Klasted"> EV5.Mvc</strong></h3>
                    </div>
                </div>
            </div>
        </div>
        <div class="container footer-bottom clearfix">
            <div class="copyright">
                &copy; Copyright
                <strong><span>Arsha</span></strong>. All Rights Reserved
            </div>
            <div class="credits">
                <!-- All the links in the footer should remain intact. -->
                <!-- You can delete the links only if you purchased the pro version. -->
                <!-- Licensing information: https://bootstrapmade.com/license/ -->
                <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/arsha-free-bootstrap-html-template-corporate/ -->
                Designed by
                <a href="https://bootstrapmade.com/">BootstrapMade</a>
            </div>
        </div>
    </footer>
    <!-- End Footer -->

    <div id="preloader"></div>
    <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i class="bi bi-arrow-up-short"></i></a>

    <!-- Vendor JS Files -->
    <script src="/vendor/aos/aos.js"></script>
    <script src="/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="/vendor/php-email-form/validate.js"></script>
    <script src="/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="/vendor/waypoints/noframework.waypoints.js"></script>

    <!-- Template Main JS File -->
    <script src="/js/main.js"></script>

</body>

</html>








<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVE.Mvc Tutorial 7 - Register the Embedded View Engine</title>
    <link href="/Content/bootstrap.css" rel="stylesheet" />
    <link href="/Content/site.css" rel="stylesheet" />

    <script src="/Scripts/modernizr-2.8.3.js"></script>


</head>
<body>
    <div class="navbar navbar-inverse navbar-fixed-top">
        <div class="container">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="/">EVE.Mvc</a>
            </div>
            <div class="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><a href="/">Home</a></li>

                    <li><a href="/Home/Contact">Contact</a></li>
                </ul>

            </div>
        </div>
    </div>
    <div class="container body-content">



        <div class="jumbotron">
            <br />
            <p class="lead">Registering the Embedded View Engine</p>
        </div>

        <div class="panel panel-info">
            <div class="panel-heading">Registering a View Engine</div>
            <div class="panel-body">
                If you want to use the Embedded View Engine you have to register it to the MVC runtime first.
                <br />
                Usually it goes like this:
                <br />
                <pre style="font-family:Consolas;font-size:13;color:gainsboro;background:#1e1e1e;"><span style="color:#4ec9b0;">ViewEngines</span><span style="color:#b4b4b4;">.</span>Engines<span style="color:#b4b4b4;">.</span>Insert(<span style="color:#b5cea8;">0</span>,&nbsp;<span style="color:#569cd6;">new</span>&nbsp;<span style="color:#4ec9b0;">EmbeddedViewEngine</span>());
</pre>
                <br />
                Obviously this code should go the the application startup code, that is either the global.asax or the Startup class.
            </div>
        </div>
        <div class="panel panel-info">
            <div class="panel-heading">Registering Embedded View Engine with view name prefixes</div>
            <div class="panel-body">
                The main purpose of View engines is to find and instantiate view classes. In ASP.NET MVC you have the option to register multiple engines, if the view resolution fails in one of them the execution continues with the next one.
                For the embedded view engine you have a shortcut to quickly signal to the MVC runtime if a view name is not intended to be resolved by this engine instance.
                <br />
                For example take the following code:
                <br />

                <pre style="font-family:Consolas;font-size:13;color:gainsboro;background:#1e1e1e;"><span style="color:#569cd6;">public</span>&nbsp;<span style="color:#4ec9b0;">ActionResult</span>&nbsp;RegisterViewEngine()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#569cd6;">return</span>&nbsp;View(<span style="color:#d69d85;">&quot;Assets.Views.Tutorial.RegisterViewEngine.html&quot;</span>);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
                <br />
                When MVC is searching for this view it will use all the registered view engines, such as the Embedded View Engine, the RAZOR View Engine, and the ASPX View engine.
                <br />
                But we know that this view belongs to the Embedded View Engine only.
                What we can do is to try and order the View engines in the ViewEngines.Engines collection in such a way that the most used engines come first.
                However the EmbeddedViewEngine ha another option as well. You can define a prefix for the view names that the view engine accepts.
                This way the Embedded View Engine can quickly decide if a view is under its jurisdiction and pass the execution to others if it is not.
                <br />
                Here is how you register the view engine with a prefix:
                <pre style="font-family:Consolas;font-size:13;color:gainsboro;background:#1e1e1e;"><span style="color:#4ec9b0;">ViewEngines</span><span style="color:#b4b4b4;">.</span>Engines<span style="color:#b4b4b4;">.</span>Insert(<span style="color:#b5cea8;">0</span>,&nbsp;<span style="color:#569cd6;">new</span>&nbsp;<span style="color:#4ec9b0;">EmbeddedViewEngine</span>(<span style="color:#d69d85;">&quot;eve-&quot;</span>));
</pre>
                <br />
                Here is how you call the view for this engine:
                <br />
                <pre style="font-family:Consolas;font-size:13;color:gainsboro;background:#1e1e1e;"><span style="color:#569cd6;">public</span>&nbsp;<span style="color:#4ec9b0;">ActionResult</span>&nbsp;RegisterViewEngine()
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#569cd6;">return</span>&nbsp;View(<span style="color:#d69d85;">&quot;eve-Assets.Views.Tutorial.RegisterViewEngine.html&quot;</span>);
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}</pre>
                <br />

                It may be that your different plugin projects require different prefixes for view names.
                In this case you just have to register an engine for each prefix.
                <br />
                <pre style="font-family:Consolas;font-size:13;color:gainsboro;background:#1e1e1e;"><span style="color:#4ec9b0;">ViewEngines</span><span style="color:#b4b4b4;">.</span>Engines<span style="color:#b4b4b4;">.</span>Insert(<span style="color:#b5cea8;">0</span>,&nbsp;<span style="color:#569cd6;">new</span>&nbsp;<span style="color:#4ec9b0;">EmbeddedViewEngine</span>(<span style="color:#d69d85;">&quot;samples-&quot;</span>));
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4ec9b0;">ViewEngines</span><span style="color:#b4b4b4;">.</span>Engines<span style="color:#b4b4b4;">.</span>Insert(<span style="color:#b5cea8;">1</span>,&nbsp;<span style="color:#569cd6;">new</span>&nbsp;<span style="color:#4ec9b0;">EmbeddedViewEngine</span>(<span style="color:#d69d85;">&quot;tutorials-&quot;</span>));</pre>
            </div>
        </div>
        <div class="panel panel-info">
            <div class="panel-heading">How does the EMbedded View Engine work</div>
            <div class="panel-body">
                The EMbedded View Engine operates according to the following logic:
                <br />
                Every view has two parts.
                <br />
                <b>A Markup part that is a piece of string containing html, or snippets of html.</b>
                <br />
                <b>
                    The other part is a view class, this view class has the option to manipulate the markup in a structured DOM like fashion.
                </b>
                <br />
                <b>
                    Both the Markup and the view class parts MUST BE identifiable by ONE view name.
                </b>
                I will show you later how to use attributes on the view class to define its view name. However to identify the markup piece a provider pattern is in place.
                By default we use the embedded resource's name as view name in the default provider. You can override this provider to your specific needs.
            </div>
        </div>


        <div class="panel panel-info">
            <div class="panel-heading">Defining Markup Provider</div>
            <div class="panel-body">
                The name of the View Engine is Embedded, this suggests that we're going to operate on embedded resources.
                In reality only the default implementation of the View engine uses embedded resources to retrieve markup.
                There is a provider pattern in place where the web application can declare the default markup provider:
                <br />
                <pre style="font-family:Consolas;font-size:13;color:gainsboro;background:#1e1e1e;"><span style="color:gray;">&nbsp;&nbsp;&lt;</span><span style="color:#569cd6;">EveProviders</span><span style="color:gray;">&gt;</span>
<span style="color:gray;">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style="color:#569cd6;">catalogProvider</span><span style="color:gray;">&nbsp;</span><span style="color:#92caf4;">name</span><span style="color:gray;">=</span><span style="color:gray;">&quot;</span><span style="color:#c8c8c8;">bindirCatalogProvider</span><span style="color:gray;">&quot;</span><span style="color:gray;">&nbsp;</span><span style="color:#92caf4;">type</span><span style="color:gray;">=</span><span style="color:gray;">&quot;</span><span style="color:#c8c8c8;">EVE.Mvc.TestWebApp.Providers.SampleEveCatalogProvider,&nbsp;EVE.Mvc.TestWebApp,&nbsp;Version=1.0.0.0,&nbsp;Culture=neutral,&nbsp;PublicKeyToken=null</span><span style="color:gray;">&quot;</span><span style="color:gray;">/&gt;</span>
<span style="color:gray;">&nbsp;&nbsp;&nbsp;&nbsp;&lt;</span><span style="color:#569cd6;">markupProvider</span><span style="color:gray;">&nbsp;</span><span style="color:#92caf4;">name</span><span style="color:gray;">=</span><span style="color:gray;">&quot;</span><span style="color:#c8c8c8;">defaultMarkupProvider</span><span style="color:gray;">&quot;</span><span style="color:gray;">&nbsp;</span><span style="color:#92caf4;">type</span><span style="color:gray;">=</span><span style="color:gray;">&quot;</span><span style="color:#c8c8c8;">EVE.Mvc.ViewEngine.EmbeddedMarkupProvider,&nbsp;EVE.Mvc,&nbsp;Version=1.0.0.0,&nbsp;Culture=neutral,&nbsp;PublicKeyToken=null</span><span style="color:gray;">&quot;</span><span style="color:gray;">/&gt;</span>
<span style="color:gray;">&nbsp;&nbsp;&lt;/</span><span style="color:#569cd6;">EveProviders</span><span style="color:gray;">&gt;</span></pre>

                <br />
                Also there is a way to define a markup provider for each of your registered view engines:
                <br />
                <pre style="font-family:Consolas;font-size:13;color:gainsboro;background:#1e1e1e;"><span style="color:#4ec9b0;">ViewEngines</span><span style="color:#b4b4b4;">.</span>Engines<span style="color:#b4b4b4;">.</span>Insert(<span style="color:#b5cea8;">0</span>,&nbsp;<span style="color:#569cd6;">new</span>&nbsp;<span style="color:#4ec9b0;">EmbeddedViewEngine</span>(<span style="color:#d69d85;">&quot;samples-&quot;</span>));&nbsp;<span style="color:#57a64a;">//&nbsp;default&nbsp;markup&nbsp;provider</span>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#4ec9b0;">ViewEngines</span><span style="color:#b4b4b4;">.</span>Engines<span style="color:#b4b4b4;">.</span>Insert(<span style="color:#b5cea8;">1</span>,&nbsp;<span style="color:#569cd6;">new</span>&nbsp;<span style="color:#4ec9b0;">EmbeddedViewEngine</span>(<span style="color:#d69d85;">&quot;tutorials-&quot;</span>,&nbsp;<span style="color:#569cd6;">new</span>&nbsp;<span style="color:#4ec9b0;">TutorialsMarkupProvider</span>()));</pre>
            </div>
        </div>
        <hr />
        <footer>
            <p>&copy; 2015 - EVE.Mvc</p>
        </footer>
    </div>

    <script src="/Scripts/jquery-2.1.4.js"></script>

    <script src="/Scripts/bootstrap.js"></script>
    <script src="/Scripts/respond.js"></script>



</body>
</html>
